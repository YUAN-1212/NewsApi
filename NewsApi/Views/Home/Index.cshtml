@{
    ViewBag.Title = "Home Page";
}
@*<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/mhDoLbDldZc3qpsJHpLogda//BVZbgYuw6kof4u2FrCedxOtgRZDTHgHUhOCVim" crossorigin="anonymous"></script>*@

<style>
    * {
        margin: 0;
        padding: 0;
    }
</style>

<form class="modal-dialog" id="app">
    <div class="row">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6 col-sm-6">
                    <select v-model="selectedCurrency1" class="form-control btn btn-primary" name="currency1">
                        <option v-for="option in options1" :value="option.currencyCode">
                            {{ option.currencyCode + '-' +  option.currencyName}}
                        </option>
                    </select>
                </div>
                <div class="col-md-6 col-sm-6">
                    <input type="text" class="form-control" v-model="rate1">
                </div>
            </div>
        </div>
        <br>
        <div class="col-lg-6">
            <button type="button" class="btn btn-default">
                <span class="glyphicon glyphicon-sort"> 交換</span>
            </button>
        </div>
        <br />
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6 col-sm-6">
                    <select v-if="options2" v-model="selectedCurrency2" class="form-control btn btn-primary" name="currency2" change="handleChange">
                        <option v-for="option in options2" :value="option.currencyCode">
                            {{ option.currencyCode + '-' +  option.currencyName}}
                        </option>
                    </select>                   
                </div>
                <div class="col-md-6 col-sm-6">
                    <input type="text" class="form-control">
                </div>
            </div>
        </div>
    </div>


</form>


<script>

    /** Vue 3 */
    const app1 = Vue.createApp({
        data() {
            return {
                message: 'Hello Vue 3.0',
                message2: '第二個訊息',
                options1: [],
                options2: [],
                selectedCurrency1: '', //用於儲存選中的幣值
                selectedCurrency2: '', //用於儲存選中的幣值
                rate1: '', //第一個匯率
            }
        },        
        created() {
            console.log('created');
        },
        mounted() {
            console.log('mounted');
            this.getData();
            this.getDDLCurrencyData2();
        },
        methods: {
            getData() {
                axios
                    .post('/Home/getData', {
                        currency: 'TWD',
                    })
                    .then(response => {
                        setTimeout(() => {
                            if (response.data.result === 'success') {
                                this.$data.selectedCurrency1 = response.data.base_code;
                                this.$data.rate1 = response.data.rates.TWD;
                            }
                        }, 1000);
                    })
                    .catch(function (error) { // 请求失败处理
                        alert(error);
                        console.log(error);
                    })
            },
            /** 第二個下拉式選單 */
            getDDLCurrencyData2() {
                axios
                    .post('/Home/getDDLCurrencyData', 
                        null
                    )
                    .then(response => {
                        setTimeout(() => {
                            if (response.data.length > 0) {
                                this.$data.options1 = response.data;
                                this.$data.options2 = response.data;
                            }
                        }, 1000);                        
                    })
                    .catch(function (error) { // 请求失败处理
                        alert(error);
                        console.log(error);
                    })
            },
        },
    }).mount('#app')
</script>